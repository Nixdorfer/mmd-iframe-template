<!DOCTYPE html><html><head><meta charset="utf-8"><style>*{margin:0;padding:0;box-sizing:border-box}body{background:#242424;font-family:system-ui,sans-serif}</style></head><body>
<script>/*__INJECT__*/</script>
<script>
window.L={loaded:{},base:"https://raw.githubusercontent.com/Nixdorfer/mmd-iframe-template/refs/heads/main/",edit:false,project:"",char:"",user:"",b64:"",res:window.R||window.innerWidth+"x"+window.innerHeight,platform:(function(){var w=window.innerWidth,h=window.innerHeight,r=w/h;return Math.abs(r-16/9)<Math.abs(r-9/19)?"pc":"mobile"})(),load:function(libs,cb){var self=this,pending=libs.filter(function(n){return!self.loaded[n]});if(!pending.length)return cb&&cb();var c=pending.length;pending.forEach(function(n){self.loaded[n]=1;fetch(self.base+"library/"+n+".js?t="+Date.now()).then(function(r){return r.text()}).then(function(t){new Function(t)();if(--c===0&&cb)cb()})})}};
(function(){var M=function(t){document.body.innerHTML="<div style=\"display:flex;align-items:center;justify-content:center;height:100vh;color:#fff\">"+t+"</div>"};M("加载中...");var p=window.P;if(!p){M("参数为空");return}var m=p.match(/^(?:(EDIT):)?([^:]+):(.+)$/);if(!m){M("格式错误");parent.postMessage({t:"error",msg:"格式错误"},"*");return}L.edit=!!m[1];L.project=m[2];var params=m[3].split(";;");L.char=params[0]||"";L.user=params[1]||"";L.b64=params[2]||"";M("加载中...");fetch(L.base+"navigator.json?t="+Date.now(),{cache:"no-store"}).then(function(r){return r.json()}).then(function(nav){var proj=nav.projects[L.project];if(!proj){M("未找到: "+L.project);parent.postMessage({t:"error",msg:"未找到: "+L.project},"*");return}fetch(L.base+proj.index+"?t="+Date.now(),{cache:"no-store"}).then(function(r){return r.text()}).then(function(h){var cfg="window.L="+JSON.stringify({loaded:{},base:L.base,edit:L.edit,project:L.project,char:L.char,user:L.user,b64:L.b64,res:L.res,platform:L.platform})+";L.load=function(libs,cb){var self=this,pending=libs.filter(function(n){return!self.loaded[n]});if(!pending.length)return cb&&cb();var c=pending.length;pending.forEach(function(n){self.loaded[n]=1;fetch(self.base+\"library/\"+n+\".js?t=\"+Date.now()).then(function(r){return r.text()}).then(function(t){new Function(t)();if(--c===0&&cb)cb()})})};";var W=function(e){document.open();document.write("<!DOCTYPE html><html><head><meta charset=\"utf-8\"></head><body><script>"+cfg+"<\/script>"+h+(e||"")+"</body></html>");document.close()};if(L.edit){fetch(L.base+"library/editor.html?t="+Date.now(),{cache:"no-store"}).then(function(r){return r.text()}).then(function(e){W(e)}).catch(function(){W()})}else{W()}}).catch(function(){M("加载失败");parent.postMessage({t:"error",msg:"加载失败"},"*")})}).catch(function(){M("导航失败");parent.postMessage({t:"error",msg:"导航失败"},"*")})})();
</script>
</body></html>
